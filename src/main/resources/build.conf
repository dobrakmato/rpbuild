# Root of project.
project {

  # Name of project.
  name: "Starving 3.0 RP"
  # Encoding used to process text files.
  encoding: "UTF-8"

  # Source directory.
  source: "."
  # Target zip file.
  target: "../latest.zip"

  # Git related settings.
  git {
    # Whether to pull changes from Git before building the resource pack.
    pull: true
    # Branch to use for build.
    branch: "develop3"
    # Whether we should exclude .git folders from final zip (recommended true).
    ignoreGitFolders: true
    # Git url.
    url: "https://github.com/pexelnet/starvingrp.git"
  }

  # Compression settings.
  compress {
    # Zip compression level.
    level: 9
  }

  # Repositories to search for plugins.
  repositories {
    central {
      url: "https://matejkormuth.eu/rpbuild/repo/"
    }

    # Name / ID of the repository.
    starving {
      # Url of the repository.
      url: "http://starving.eu/rpbuild/"
    }
  }

  # Configurable arbitrary properties.
  properties {
    # Size of block pack.
    blocksSize: 128
    # Size of item in resource pack.
    itemsSize: 256
  }

  # Build process specification.
  build {
    # Global exclude rules.
    exclude: ["rpbuild.xml" "**.jar" "**.zip" "**.bat" "**.sh" "**.php" "**.log" ".gitkeep" "**.db" ".git" "**.git*"]

    # Select directory.
    "assets/minecraft" {
      # Plugins to run on all files in this directory.
      # If specified plugin does not compile files, it will invoke generate task instead.
      plugins {
        # Generate pack.mcmeta file from information about build.
        rpbuild-packmcmeta-plugin {}

        # Minify all JSON files in this directory and subdrectories.
        rpbuild-jsonminify-plugin {}
      }

      # Select subdirectory 'sounds'.
      "sounds" {
        plugins {
          # Generate sounds.json from files in sounds directory.
          starving-soundsjson-plugin {
            # Threshold of sound length for streaming: true.
            streamingThreshold: 2500

            # File contaning category mapping for all sounds.
            categories: "categories.json"
          }

          # Generate more variations of specific sound files.
          starving-soundprocessing-plugin {
            #########################
            #       CONFIGURE!      #
            #########################
          }
        }
      }

      # Select subdirectory 'textures'.
      "textures" {
        plugins {

          # Run optipng using optipng plugin.
          rpbuild-optipng-plugin {
            # Optimization level (0-7) default 2.
            level: 7

            # Max amount of images that will be processed in parallel.
            instances: 4
          }

          # PngQuant plugin is not yet implemented.
          # rpbuild-pngquant-plugin {}

          # Mangle texture names.
          # rpbuild-mangle-plugin {
          #  # Mangle plugin mode.
          #  mode: "textures"
          #  # Name of source map file.
          #  sourcemap: "textures.map"
          #  # Multithreaded?
          #  multithreaded: true
          # }
        }

        # Select subdirectory 'blocks'.
        "blocks" {
          plugins {
            # Downscale all textures.
            rpbuild-downscale-plugin {
              # Max resolution of texture in pixels.
              maxResolution: ${project.properties.blocksSize}
              # Type of interpolation to use (nearest, bilinear, bicubic).
              interpolation: "bicubic"
            }
          }
        }

        # Select subdirectory 'items'.
        "items" {
          plugins {
            # Downscale all textures.
            rpbuild-downscale-plugin {
              # Max resolution of texture in pixels.
              maxResolution: ${project.properties.itemsSize}
              # Type of interpolation to use (nearest, bilinear, bicubic).
              interpolation: "bicubic"
            }
          }
        }
      }

      # Select subdirectory 'models'.
      "models" {
        # Local (folder and subfolder) exclude rules.
        exclude: ["*.bdc3D"]

        plugins {
          # Mangle model names.
          # rpbuild-mangle-plugin {
          #  # Mangle plugin mode.
          #  mode: "models"
          #  # Name of source map file.
          #  sourcemap: "models.map"
          # }
        }

        # Select subdirectory 'blocks'.
        "blocks" {
          plugins {
            # Fix missing 'particle' texture on models.
            starving-fixparticle-plugin {}
          }
        }
      }

      # Select subdirectory 'blockstates'.
      "blockstates" {
        plugins {

        }
      }
    }
  }
}